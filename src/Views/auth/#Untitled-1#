Tons of general cleanup

In preparation of wider release!